config loaded.
nll weight: 1.0, pixel weight: 1.0, vgg weight: 1.0
use crop dataset for vgg loss
/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG19_Weights.IMAGENET1K_V1`. You can also use `weights=VGG19_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/vgg19-dcbb9e9d.pth" to /root/.cache/torch/hub/checkpoints/vgg19-dcbb9e9d.pth

 73%|█████████████████████████████████████████████▏                | 400M/548M [00:02<00:00, 194MB/s]
train dataset: sr-implicit-downsampled-fast-crop

100%|██████████████████████████████████████████████████████████████| 548M/548M [00:03<00:00, 190MB/s]
train dataset: size=16120
  inp: shape=(3, 48, 48)
  coord: shape=(48, 48, 2)
  cell: shape=(2,)
  gt: shape=(3, 48, 48)
/usr/local/lib/python3.10/dist-packages/torch/functional.py:507: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at ../aten/src/ATen/native/TensorShape.cpp:3549.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
val dataset: size=1600
  inp: shape=(3, 48, 48)
  coord: shape=(48, 48, 2)
  cell: shape=(2,)
  gt: shape=(3, 48, 48)
device: cuda:0
model: #params=1.6M
lr: 0.0001
train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()










































































































train: 100%|████████████████████████████████████████████████████▊| 1005/1008 [03:38<00:00,  4.76it/s]
val:   0%|                                                                   | 0/100 [00:00<?, ?it/s]/usr/lib/python3.10/multiprocessing/popen_fork.py:66: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
  self.pid = os.fork()




val:  89%|███████████████████████████████████████████████████▌      | 89/100 [00:07<00:00, 13.59it/s]
epoch 1/30, train: total_loss=1494746.9992, nll=52.9072, pix_l=1494688.9480, vgg_l=5.1557, val: psnr=4.9343, 3.9m 3.9m/1.9h















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]
















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]

















































































































val:  93%|█████████████████████████████████████████████████████▉    | 93/100 [00:08<00:00, 13.26it/s]



















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]


















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]


















































































































val:  99%|█████████████████████████████████████████████████████████▍| 99/100 [00:08<00:00, 13.57it/s]

















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]

















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]
















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]

















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]


















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]



















































































































train:   0%|                                                        | 1/1008 [00:01<26:35,  1.58s/it]

















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]


















































































































train:   0%|                                                        | 1/1008 [00:01<26:45,  1.59s/it]
















































































































train:   0%|                                                                | 0/1008 [00:00<?, ?it/s]














































